//////////////////////////////////////////////////////////////////////////////
/*             Обычные импорты. Нужно еще больше слов ааа                   */
//////////////////////////////////////////////////////////////////////////////
import * as alt from 'alt'
import * as native from 'natives'
//////////////////////////////////////////////////////////////////////////////
/*             Обычные импорты. Нужно еще больше слов ааа                   */
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
/*             Какие-то важные константы аааааааааааааааа                   */
//////////////////////////////////////////////////////////////////////////////
const player = alt.Player.local
let webview;
//////////////////////////////////////////////////////////////////////////////
/*             Какие-то важные константы аааааааааааааааа                   */
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
/*             Вызов ивентов для работы с веб-интерфейсом                   */
//////////////////////////////////////////////////////////////////////////////
alt.onServer('upgradeEngine:Start', Start)

alt.onServer('upgradeEngine:Close', Close)
//////////////////////////////////////////////////////////////////////////////
/*             ызов ивентов для работы с веб-интерфейсом                   */
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
/*     Функции. Занес в них для личного удобства. Надеюсь решение верное.   */
//////////////////////////////////////////////////////////////////////////////
function Start() {
    alt.setTimeout(() => {
        if (webview === undefined  && player.vehicle != undefined) {
            webview = new alt.WebView('http://resource/client/html/index.html');
            webview.focus();
            let vehicle = player.vehicle.scriptID
            alt.showCursor(true)
            alt.setCamFrozen(true)
            native.freezeEntityPosition(vehicle, true)
        }
        webview.on('upgradeEngine:Wait', (data) => {alt.emitServer('upgradeEngine:Install', data)})
    }, 100)
}

function Close() {
    if (webview != undefined) {
        alt.setCamFrozen(false)
        alt.showCursor(false)
        native.freezeEntityPosition(player.vehicle, false);
        native.displayRadar(true)
        webview.destroy();
        webview = undefined;
    }
}
//////////////////////////////////////////////////////////////////////////////
/*     Функции. Занес в них для личного удобства. Надеюсь решение верное.   */
//////////////////////////////////////////////////////////////////////////////
